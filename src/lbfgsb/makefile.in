.SUFFIXES: .f .o
#-------------------------------------------------------------------------------
# Fortran
FC=@FC@

# debug option
DBG_FLAG=@dbg_flag@
ifeq ($(DBG_FLAG),True)
	FCFLAGS_DBG=-g -Wall -pedantic -fbounds-check -O -Wuninitialized -ffpe-trap=invalid,zero,overflow -fbacktrace
else
	FCFLAGS_DBG=
endif

# other options
FCFLAGS_OMP=-fopenmp
FCFLAGS_OPT=-O2
FCFLAGS_BLAS=@LDFLAGS@ @blaslib@

# collect above options
FCFLAGS=$(FCFLAGS_DBG) -fPIC $(FCFLAGS_OPT) $(FCFLAGS_BLAS) $(FCFLAGS_OMP)

#-------------------------------------------------------------------------------
all: liblbfgsb.a

.f.o:
	$(FC) -c $< $(FCFLAGS)

liblbfgsb.a: lbfgsb.o linpack.o timer.o
	ar rcs liblbfgsb.a lbfgsb.o linpack.o timer.o

install: all

clean:
	rm -f *.o *.a

uninstall: clean
	rm -f makefile
